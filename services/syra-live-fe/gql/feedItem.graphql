fragment FeedComment on Comment {
    id
    likeCount
    text
    updatedAt
    author {
        ...FeedUser
    }
}

fragment DisplayFeedItem on FeedItem {
    id
    likeCount
    commentCount
    updatedAt
    text
    author {
        ...FeedUser
    }
    mixdown {
        ...FeedMixdown
    }
    comments(orderBy: [{createdAt: desc}]) {
        ...FeedComment
        subComments(orderBy: [{createdAt: desc}]) {
            ...FeedComment
        }
    }
}

query feedItemsByHandle($handle: String!, $cursor: String) {
    feedItems(where: {author: {is: {handle: {equals: $handle}}}}, cursor: {id: $cursor}, take: 8, orderBy: [{createdAt: desc}]) {
        id
    }
}

query myFeed($me: String) {
    feedItems(where: {author: {is: {followedBy: {some: {id: {equals: $me}}}}}}, orderBy: [{createdAt: desc}], take: 5) {
        id
    }
}

query feedItemById($id: String!) {
    feedItem(where: {id: $id}) {
        ...DisplayFeedItem
    }
}

mutation createFeedItem($text: String!, $mixdownId: String, $me: String) {
    createFeedItem(data: {text: $text, mixdown: {connect: {id: $mixdownId}}, author: {connect: {id: $me}}}) {
        id
        likeCount
        commentCount
        createdAt
        updatedAt
    }
}

mutation createTextFeedItem($text: String!, $me: String) {
    createFeedItem(data: {text: $text, author: {connect: {id: $me}}}) {
        id
        likeCount
        commentCount
        createdAt
        updatedAt
        mixdown {
            ...FeedMixdown
        }
    }
}